#!/bin/bash

SCRIPT_PATH="/usr/local/bin/update-all"
REPO_LIST="$HOME/.repo-autosync.list"

# –°–æ–∑–¥–∞—ë–º —Ñ–∞–π–ª, –µ—Å–ª–∏ –µ–≥–æ –Ω–µ—Ç
if [ ! -f "$REPO_LIST" ]; then
  echo "üìÑ –°–æ–∑–¥–∞—é $REPO_LIST"
  touch "$REPO_LIST"
fi

# –î–æ–±–∞–≤–ª—è–µ–º –≤ crontab, –µ—Å–ª–∏ –Ω–µ—Ç –∑–∞–ø–∏—Å–∏
if ! crontab -l 2>/dev/null | grep -q "$SCRIPT_PATH"; then
  (crontab -l 2>/dev/null; echo "*/5 * * * * $SCRIPT_PATH") | crontab -
  echo "üïí –î–æ–±–∞–≤–ª–µ–Ω–∞ –∑–∞–¥–∞—á–∞ –≤ cron: $SCRIPT_PATH"
else
  echo "‚ÑπÔ∏è –ó–∞–¥–∞—á–∞ —É–∂–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç –≤ crontab."
fi
