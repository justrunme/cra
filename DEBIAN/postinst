#!/bin/bash

SCRIPT_PATH="/usr/local/bin/update-all"
REPO_LIST="$HOME/.repo-autosync.list"

# üóÇÔ∏è –°–æ–∑–¥–∞—ë–º —Å–ø–∏—Å–æ–∫, –µ—Å–ª–∏ –Ω–µ—Ç
if [ ! -f "$REPO_LIST" ]; then
  echo "üìÑ –°–æ–∑–¥–∞—é $REPO_LIST"
  touch "$REPO_LIST"
fi

# üïí –î–æ–±–∞–≤–ª—è–µ–º –≤ crontab
if ! crontab -l 2>/dev/null | grep -q "$SCRIPT_PATH"; then
  (crontab -l 2>/dev/null; echo "*/1 * * * * $SCRIPT_PATH") | sort -u | crontab -
  echo "‚úÖ –î–æ–±–∞–≤–ª–µ–Ω–∞ –∑–∞–¥–∞—á–∞ –≤ cron: $SCRIPT_PATH (–∫–∞–∂–¥—É—é –º–∏–Ω—É—Ç—É)"
else
  echo "‚ÑπÔ∏è –ó–∞–¥–∞—á–∞ —É–∂–µ –µ—Å—Ç—å –≤ crontab."
fi
